<html>
<head>
  <meta charset="UTF-8">
  <title>hoge hoge</title>
</head>
<body>
  <h1 id="room_h1"></h1>
  <ul id="msg_list"></ul>
  <form action="" method="post" onsubmit="return false;">
    <select id="rooms">
      <option value="room1">緑の部屋</option>
      <option value="room2">赤の部屋</option>
      <option value="room3">黒の部屋</option>
      <option value="room4">白の部屋</option>
    </select>
    <input type="text" class="text" id="name" />
    <input type="text" class="text" id="message" />
    <input type="submit" class="button" id="send" value="送信" />
  </form>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
  <script src="/socket.io/socket.io.js"></script>
  <script>
    var socket = io.connect('http://localhost:3000');
    socket.on("sendMessageToClient", function(data) {
      appendTag($("#msg_list"), "li", data.value + createHideTag(data.hash));
    });

    socket.on("sendMessageToClientRoom", function(data) {
      appendTag($("#msg_list"), "li", data.value + createHideTag(data.hash));
      $("#room_h1").text("[" + data.room + "]");
    });

    $("input#send").click(function() {
      var name = $("#name").val();
      var msg = $("#message").val();
      var room = $("#rooms").val();
      $("#message").val("");
      socket.emit("sendMessageToServer", {name:name,value:msg,room:room});
    });

    function appendTag($id, tagName, value) {
      $id.append($("<" + tagName + ">").html(value));
    }

    function createHideTag(value) {
      return "<span style=\"display: none;\">@" + value + "</span>";
    }
  </script>
</body>
</html>
